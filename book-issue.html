<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Book Issue</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <h2>Book Issue</h2>
    <nav>
        <a href="transactions.html">Transactions</a> |
        <a href="user-home.html">Home</a>
    </nav>

    <form id="bookIssueForm">
        <label for="bookName">Book Name*</label>
        <input type="text" id="bookName"><br><br>

        <label for="authorName">Author Name*</label>
        <input type="text" id="authorName" readonly><br><br>

        <label for="issueDate">Issue Date*</label>
        <input type="date" id="issueDate"><br><br>

        <label for="returnDate">Return Date*</label>
        <input type="date" id="returnDate"><br><br>

        <label for="remarks">Remarks</label>
        <textarea id="remarks"></textarea><br><br>

        <button type="submit">Issue Book</button>
    </form>

    <p id="errorMsg" style="color:red;"></p>

    <script>
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('issueDate').value = today;
        document.getElementById('issueDate').min = today;

        const returnDefault = new Date();
        returnDefault.setDate(returnDefault.getDate() + 15);
        document.getElementById('returnDate').value = returnDefault.toISOString().split('T')[0];
        document.getElementById('returnDate').max = returnDefault.toISOString().split('T')[0];

        document.getElementById('bookName').addEventListener('blur', function(){
            // Auto-populate author for demo
            const book = this.value.toLowerCase();
            if(book === 'harry potter') document.getElementById('authorName').value = 'J.K. Rowling';
            else if(book === 'hobbit') document.getElementById('authorName').value = 'J.R.R. Tolkien';
            else document.getElementById('authorName').value = '';
        });

        document.getElementById('bookIssueForm').addEventListener('submit', function(e){
            e.preventDefault();
            const book = document.getElementById('bookName').value.trim();
            const author = document.getElementById('authorName').value.trim();
            const issue = document.getElementById('issueDate').value;
            const ret = document.getElementById('returnDate').value;

            if(!book || !author || !issue || !ret){
                document.getElementById('errorMsg').innerText = 'Please fill all mandatory fields';
                return;
            }
            alert('Book Issued Successfully!');
            this.reset();
        });
    </script>
</body>
</html>
